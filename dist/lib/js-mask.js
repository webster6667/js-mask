!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("@babel/runtime/helpers/esm/toConsumableArray")):"function"==typeof define&&define.amd?define(["exports","@babel/runtime/helpers/esm/toConsumableArray"],r):r((e="undefined"!=typeof globalThis?globalThis:e||self).jsMask={},e._toConsumableArray)}(this,(function(e,r){"use strict";function a(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=a(r),t=function(e,r,a){return e.map((function(e){return e===a?r:e}))},i=function(e,r){var a=/\[[\\d\w-]+\]/g,n=e.match(a);return{regExpsArray:n?Array.from(n).reverse():[],maskSymbolsArray:e.replace(a,r).split("")}},f=function(e,r,a,t,i){var f=n.default(a),l=0;return e.forEach((function(e,a){var n=r[a];if(e===t){var o=f.pop(),u=o?new RegExp(o):null;u&&u.test(n)&&a>=i&&0===l&&(l=a)}})),l},l=function(e,r){for(var a=r||{},n=a.maskPattern,t=void 0===n?"":n,f=a.placeholder,l=void 0===f?"_":f,o=i(t,"[").maskSymbolsArray,u=o.length,s=[],d=0;d<u;d++){var c=o[d],p=e[d],v="["===c;if(p){if(p===c)continue;v&&p!==l&&s.push(p)}}return s.join("")};e.mask=function(e,r){var a=r||{},o=a.maskPattern,u=void 0===o?"":o,s=a.placeholder,d=void 0===s?"":s,c=a.inputCaretPositionIndex,p=void 0===c?0:c,v=a.prevValue,m=void 0===v?"":v,h=d,b="[",k=i(u,b),y=k.regExpsArray,g=k.maskSymbolsArray,x=t(n.default(g),d,b).join(""),j=g.length;if(h){var A=m.length,E=e.length,P=E>A,V=E<A,w=A===E,C=l(m,r),_=n.default(m.split("")),O=e.split(""),R=n.default(g),S=n.default(_);if(P){var M=E-A,T=M>1;if(1===M){var q=p>0?p-1:0,I=O[q],z=f(g,_,y,b,q)===q?0:1;S.splice(q,z,I)}else if(T){var B=p-M;!function(e,r,a,n,t,i,f){for(var l=n+f,o=a.slice(n,l),u=t>0?t:r.length,s=0,d=n;d<u;d++)r[d]===i&&s<f&&(s++,e.splice(d+1-s,1));o.forEach((function(r,a){e.splice(n+a,0,r)}))}(S,_,O,B,f(g,_,y,b,B),d,M)}}else if(V){var D=A-E,F=n.default(_).slice(p,p+D).join(""),G=n.default(O);F.split("").forEach((function(e,r){G.splice(p+r,0,"]")})),G.forEach((function(e,r){var a=g[r];"]"===e&&(G[r]=a===b?d:a)})),S=G}else w&&(S=O);if(!V){for(var H=0,J=n.default(y),K=[],L=0;L<j;){var N=g[L],Q=S[H],U=N===b;if(N!==b)L++,K.push(N),Q===N&&H++;else if(U){var W=J[0],X=W?new RegExp(W):null;if(X&&X.test(Q)?(J.pop(),R[L]=Q,L++,H++):Q===d||_[H]===d?(R[L]=d,L++,H++):w&&!K.includes(Q)?(R[L]=_[H],L++,H++):(R[L]=d,H++),H>E)break}}S=t(R,d,b)}var Y=S.join("");return{maskedValue:Y,unmaskedValue:l(Y,r),unmaskedPrevValue:C,newCaretPosition:function(e,r,a,n,t,i,f,l,o){var u=t;if(a.includes(i))for(var s=0;s<r.length;s++)if(r[s]===n)if(e)s===t?u=s:s<t&&(u=s+1);else if(s>=t){u=s;break}var d=1===o;return f===l&&(u=l.indexOf(i)),d&&(u=l.indexOf(i)+1),u}(V,g,S,b,p,d,Y,x,E)}}for(var Z=0,$=n.default(g),ee=0;ee<j;){var re=g[ee],ae=e[Z],ne=y.length,te=re!==b,ie=re===b;if(!ae){if(!ae){if(ne>0){$=$.slice(0,ee);break}break}break}if(te)ee++,ae===re&&Z++;else if(ie){var fe=y[0],le=fe?new RegExp(fe):null;le&&le.test(ae)?($[ee]=ae,y.pop(),ee++,Z++):Z++}}var oe=$.join("");return{maskedValue:oe,unmaskedValue:l(oe,r)}},e.unmask=l,Object.defineProperty(e,"__esModule",{value:!0})}));
