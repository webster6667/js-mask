import e from"@babel/runtime/helpers/esm/toConsumableArray";var r=function(e,r,a){return e.map((function(e){return e===a?r:e}))},a=function(e,r){var a=/\[[\\d\w-]+\]/g,n=e.match(a);return{regExpsArray:n?Array.from(n).reverse():[],maskSymbolsArray:e.replace(a,r).split("")}},n=function(r,a,n,i,t){var o=e(n),l=0;return r.forEach((function(e,r){var n=a[r];if(e===i){var f=o.pop(),s=f?new RegExp(f):null;s&&s.test(n)&&r>=t&&0===l&&(l=r)}})),l},i=function(e,r){for(var n=r||{},i=n.maskPattern,t=void 0===i?"":i,o=n.placeholder,l=void 0===o?"_":o,f=a(t,"[").maskSymbolsArray,s=f.length,u=[],v=0;v<s;v++){var c=f[v],p=e[v],m="["===c;if(p){if(p===c)continue;m&&p!==l&&u.push(p)}}return u.join("")},t=function(t,o){var l=o||{},f=l.maskPattern,s=void 0===f?"":f,u=l.placeholder,v=void 0===u?"":u,c=l.inputCaretPositionIndex,p=void 0===c?0:c,m=l.prevValue,d=void 0===m?"":m,h=v,k="[",g=a(s,k),b=g.regExpsArray,y=g.maskSymbolsArray,x=r(e(y),v,k).join(""),E=y.length;if(h){var A=d.length,V=t.length,j=V>A,w=V<A,P=A===V,C=i(d,o),R=e(d.split("")),S=t.split(""),O=e(y),I=e(R);if(j){var _=V-A,q=_>1;if(1===_){var z=p>0?p-1:0,B=S[z],D=n(y,R,b,k,z)===z?0:1;I.splice(z,D,B)}else if(q){var F=p-_;!function(e,r,a,n,i,t,o){for(var l=n+o,f=a.slice(n,l),s=i>0?i:r.length,u=0,v=n;v<s;v++)r[v]===t&&u<o&&(u++,e.splice(v+1-u,1));f.forEach((function(r,a){e.splice(n+a,0,r)}))}(I,R,S,F,n(y,R,b,k,F),v,_)}}else if(w){var G=A-V,H=e(R).slice(p,p+G).join(""),J=e(S);H.split("").forEach((function(e,r){J.splice(p+r,0,"]")})),J.forEach((function(e,r){var a=y[r];"]"===e&&(J[r]=a===k?v:a)})),I=J}else P&&(I=S);if(!w){for(var K=0,L=e(b),M=[],N=0;N<E;){var Q=y[N],T=I[K],U=Q===k;if(Q!==k)N++,M.push(Q),T===Q&&K++;else if(U){var W=L[0],X=W?new RegExp(W):null;if(X&&X.test(T)?(L.pop(),O[N]=T,N++,K++):T===v||R[K]===v?(O[N]=v,N++,K++):P&&!M.includes(T)?(O[N]=R[K],N++,K++):(O[N]=v,K++),K>V)break}}I=r(O,v,k)}var Y=I.join("");return{maskedValue:Y,unmaskedValue:i(Y,o),unmaskedPrevValue:C,newCaretPosition:function(e,r,a,n,i,t,o,l,f){var s=i;if(a.includes(t))for(var u=0;u<r.length;u++)if(r[u]===n)if(e)u===i?s=u:u<i&&(s=u+1);else if(u>=i){s=u;break}var v=1===f;return o===l&&(s=l.indexOf(t)),v&&(s=l.indexOf(t)+1),s}(w,y,I,k,p,v,Y,x,V)}}for(var Z=0,$=e(y),ee=0;ee<E;){var re=y[ee],ae=t[Z],ne=b.length,ie=re!==k,te=re===k;if(!ae){if(!ae){if(ne>0){$=$.slice(0,ee);break}break}break}if(ie)ee++,ae===re&&Z++;else if(te){var oe=b[0],le=oe?new RegExp(oe):null;le&&le.test(ae)?($[ee]=ae,b.pop(),ee++,Z++):Z++}}var fe=$.join("");return{maskedValue:fe,unmaskedValue:i(fe,o)}};export{t as mask,i as unmask};
