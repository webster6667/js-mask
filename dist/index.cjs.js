"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var r=e(require("@babel/runtime/helpers/toConsumableArray")),a=function(e,r,a){return e.map((function(e){return e===a?r:e}))},n=function(e,r){var a=/\[[\\d\w-]+\]/g,n=e.match(a);return{regExpsArray:n?Array.from(n).reverse():[],maskSymbolsArray:e.replace(a,r).split("")}},t=function(e,a,n,t,i){var l=r.default(n),f=0;return e.forEach((function(e,r){var n=a[r];if(e===t){var u=l.pop(),o=u?new RegExp(u):null;o&&o.test(n)&&r>=i&&0===f&&(f=r)}})),f},i=function(e,r){for(var a=r||{},t=a.maskPattern,i=void 0===t?"":t,l=a.placeholder,f=void 0===l?"_":l,u=n(i,"[").maskSymbolsArray,o=u.length,s=[],v=0;v<o;v++){var c=u[v],p=e[v],d="["===c;if(p){if(p===c)continue;d&&p!==f&&s.push(p)}}return s.join("")};exports.mask=function(e,l){var f=l||{},u=f.maskPattern,o=void 0===u?"":u,s=f.placeholder,v=void 0===s?"":s,c=f.inputCaretPositionIndex,p=void 0===c?0:c,d=f.prevValue,m=void 0===d?"":d,h=v,k="[",b=n(o,k),g=b.regExpsArray,y=b.maskSymbolsArray,x=a(r.default(y),v,k).join(""),E=y.length;if(h){var j=m.length,A=e.length,P=A>j,V=A<j,w=j===A,C=i(m,l),O=r.default(m.split("")),R=e.split(""),S=r.default(y),_=r.default(O);if(P){var q=A-j,I=q>1;if(1===q){var M=p>0?p-1:0,z=R[M],B=t(y,O,g,k,M)===M?0:1;_.splice(M,B,z)}else if(I){var D=p-q;!function(e,r,a,n,t,i,l){for(var f=n+l,u=a.slice(n,f),o=t>0?t:r.length,s=0,v=n;v<o;v++)r[v]===i&&s<l&&(s++,e.splice(v+1-s,1));u.forEach((function(r,a){e.splice(n+a,0,r)}))}(_,O,R,D,t(y,O,g,k,D),v,q)}}else if(V){var F=j-A,G=r.default(O).slice(p,p+F).join(""),H=r.default(R);G.split("").forEach((function(e,r){H.splice(p+r,0,"]")})),H.forEach((function(e,r){var a=y[r];"]"===e&&(H[r]=a===k?v:a)})),_=H}else w&&(_=R);if(!V){for(var J=0,K=r.default(g),L=[],N=0;N<E;){var Q=y[N],T=_[J],U=Q===k;if(Q!==k)N++,L.push(Q),T===Q&&J++;else if(U){var W=K[0],X=W?new RegExp(W):null;if(X&&X.test(T)?(K.pop(),S[N]=T,N++,J++):T===v||O[J]===v?(S[N]=v,N++,J++):w&&!L.includes(T)?(S[N]=O[J],N++,J++):(S[N]=v,J++),J>A)break}}_=a(S,v,k)}var Y=_.join("");return{maskedValue:Y,unmaskedValue:i(Y,l),unmaskedPrevValue:C,newCaretPosition:function(e,r,a,n,t,i,l,f,u){var o=t;if(a.includes(i))for(var s=0;s<r.length;s++)if(r[s]===n)if(e)s===t?o=s:s<t&&(o=s+1);else if(s>=t){o=s;break}var v=1===u;return l===f&&(o=f.indexOf(i)),v&&(o=f.indexOf(i)+1),o}(V,y,_,k,p,v,Y,x,A)}}for(var Z=0,$=r.default(y),ee=0;ee<E;){var re=y[ee],ae=e[Z],ne=g.length,te=re!==k,ie=re===k;if(!ae){if(!ae){if(ne>0){$=$.slice(0,ee);break}break}break}if(te)ee++,ae===re&&Z++;else if(ie){var le=g[0],fe=le?new RegExp(le):null;fe&&fe.test(ae)?($[ee]=ae,g.pop(),ee++,Z++):Z++}}var ue=$.join("");return{maskedValue:ue,unmaskedValue:i(ue,l)}},exports.unmask=i;
